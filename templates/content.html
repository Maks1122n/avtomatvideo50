<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω—Ç–µ–Ω—Ç - MediaFlux Hub</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="logo">
                <i class="fas fa-video"></i>
                <span>MediaFlux Hub</span>
            </div>
            
            <ul class="menu">
                <li class="menu-item">
                    <a href="/">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="/accounts">
                        <i class="fas fa-users"></i>
                        <span>–ê–∫–∫–∞—É–Ω—Ç—ã</span>
                        <span class="badge">3</span>
                    </a>
                </li>
                <li class="menu-item active">
                    <a href="/content">
                        <i class="fas fa-folder"></i>
                        <span>–ö–æ–Ω—Ç–µ–Ω—Ç</span>
                        <span class="badge">156</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="/schedule">
                        <i class="fas fa-calendar-alt"></i>
                        <span>–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="/analytics">
                        <i class="fas fa-chart-line"></i>
                        <span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="/proxies">
                        <i class="fas fa-shield-alt"></i>
                        <span>–ü—Ä–æ–∫—Å–∏</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="/settings">
                        <i class="fas fa-cog"></i>
                        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</h1>
                    <span class="breadcrumb">–ì–ª–∞–≤–Ω–∞—è / –ö–æ–Ω—Ç–µ–Ω—Ç</span>
                </div>
                <div class="header-right">
                    <button class="btn btn-primary" onclick="document.getElementById('videoFiles').click()">
                        <i class="fas fa-upload"></i>
                        –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ
                    </button>
                    <div class="user-profile">
                        <i class="fas fa-user"></i>
                        <span>Administrator</span>
                    </div>
                </div>
            </header>

            <!-- Upload Section -->
            <div class="content">
                <div class="content-section">
                    <div class="upload-container">
                        <h2>–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h2>
                        
                        <div class="upload-area" id="uploadArea">
                            <div class="upload-content">
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã —Å—é–¥–∞</h3>
                                <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤</p>
                                <p class="upload-formats">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: MP4, MOV, AVI (–º–∞–∫—Å. 100MB)</p>
                                <input type="file" id="videoFiles" multiple accept="video/mp4,video/mov,video/avi" style="display: none;">
                                <button class="btn btn-primary" onclick="document.getElementById('videoFiles').click()">
                                    <i class="fas fa-folder-open"></i>
                                    –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã
                                </button>
                            </div>
                        </div>

                        <div class="upload-options">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="videoCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                                    <select id="videoCategory">
                                        <option value="motivation">üî• –ú–æ—Ç–∏–≤–∞—Ü–∏—è</option>
                                        <option value="lifestyle">‚ú® –õ–∞–π—Ñ—Å—Ç–∞–π–ª</option>
                                        <option value="business">üíº –ë–∏–∑–Ω–µ—Å</option>
                                        <option value="entertainment">üéâ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                                        <option value="education">üìö –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="videoTags">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                                    <input type="text" id="videoTags" placeholder="–º–æ—Ç–∏–≤–∞—Ü–∏—è, —É—Å–ø–µ—Ö, —Ü–µ–ª–∏">
                                </div>
                            </div>
                        </div>

                        <!-- Upload Progress -->
                        <div class="upload-progress" id="uploadProgress" style="display: none;">
                            <h3>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤...</h3>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill"></div>
                                </div>
                                <span class="progress-text" id="progressText">0%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Folders -->
                <div class="content-section">
                    <div class="section-header">
                        <h2>–ü–∞–ø–∫–∏ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</h2>
                        <div class="section-actions">
                            <button class="btn btn-secondary" onclick="refreshFolders()">
                                <i class="fas fa-sync-alt"></i>
                                –û–±–Ω–æ–≤–∏—Ç—å
                            </button>
                            <button class="btn btn-secondary" onclick="createNewFolder()">
                                <i class="fas fa-plus"></i>
                                –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É
                            </button>
                        </div>
                    </div>
                    
                    <div class="folders-grid" id="foldersGrid">
                        <!-- Demo folder 1 -->
                        <div class="folder-card">
                            <div class="folder-header">
                                <div class="folder-icon">
                                    <i class="fas fa-fire"></i>
                                </div>
                                <div class="folder-info">
                                    <h3>–ú–æ—Ç–∏–≤–∞—Ü–∏—è</h3>
                                    <span class="folder-path">/content/motivation/</span>
                                </div>
                                <div class="folder-menu">
                                    <button class="btn-icon">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="folder-stats">
                                <div class="stat">
                                    <span class="stat-label">–í–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤</span>
                                    <span class="stat-value">45</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</span>
                                    <span class="stat-value">23 (51%)</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">–†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏</span>
                                    <span class="stat-value">2.1 GB</span>
                                </div>
                            </div>
                            
                            <div class="folder-actions">
                                <button class="btn btn-small btn-secondary" onclick="openFolder('motivation')">
                                    <i class="fas fa-eye"></i>
                                    –ü—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                                <button class="btn btn-small btn-primary" onclick="manageFolder('motivation')">
                                    <i class="fas fa-cog"></i>
                                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                                </button>
                            </div>
                        </div>

                        <!-- Demo folder 2 -->
                        <div class="folder-card">
                            <div class="folder-header">
                                <div class="folder-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="folder-info">
                                    <h3>–õ–∞–π—Ñ—Å—Ç–∞–π–ª</h3>
                                    <span class="folder-path">/content/lifestyle/</span>
                                </div>
                                <div class="folder-menu">
                                    <button class="btn-icon">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="folder-stats">
                                <div class="stat">
                                    <span class="stat-label">–í–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤</span>
                                    <span class="stat-value">38</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</span>
                                    <span class="stat-value">15 (39%)</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">–†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏</span>
                                    <span class="stat-value">1.8 GB</span>
                                </div>
                            </div>
                            
                            <div class="folder-actions">
                                <button class="btn btn-small btn-secondary" onclick="openFolder('lifestyle')">
                                    <i class="fas fa-eye"></i>
                                    –ü—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                                <button class="btn btn-small btn-primary" onclick="manageFolder('lifestyle')">
                                    <i class="fas fa-cog"></i>
                                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                                </button>
                            </div>
                        </div>

                        <!-- Demo folder 3 -->
                        <div class="folder-card">
                            <div class="folder-header">
                                <div class="folder-icon">
                                    <i class="fas fa-briefcase"></i>
                                </div>
                                <div class="folder-info">
                                    <h3>–ë–∏–∑–Ω–µ—Å</h3>
                                    <span class="folder-path">/content/business/</span>
                                </div>
                                <div class="folder-menu">
                                    <button class="btn-icon">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="folder-stats">
                                <div class="stat">
                                    <span class="stat-label">–í–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤</span>
                                    <span class="stat-value">29</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</span>
                                    <span class="stat-value">12 (41%)</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">–†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏</span>
                                    <span class="stat-value">1.3 GB</span>
                                </div>
                            </div>
                            
                            <div class="folder-actions">
                                <button class="btn btn-small btn-secondary" onclick="openFolder('business')">
                                    <i class="fas fa-eye"></i>
                                    –ü—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                                <button class="btn btn-small btn-primary" onclick="manageFolder('business')">
                                    <i class="fas fa-cog"></i>
                                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                                </button>
                            </div>
                        </div>

                        <!-- Demo folder 4 -->
                        <div class="folder-card">
                            <div class="folder-header">
                                <div class="folder-icon">
                                    <i class="fas fa-laugh"></i>
                                </div>
                                <div class="folder-info">
                                    <h3>–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</h3>
                                    <span class="folder-path">/content/entertainment/</span>
                                </div>
                                <div class="folder-menu">
                                    <button class="btn-icon">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="folder-stats">
                                <div class="stat">
                                    <span class="stat-label">–í–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤</span>
                                    <span class="stat-value">52</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ</span>
                                    <span class="stat-value">31 (60%)</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">–†–∞–∑–º–µ—Ä –ø–∞–ø–∫–∏</span>
                                    <span class="stat-value">2.7 GB</span>
                                </div>
                            </div>
                            
                            <div class="folder-actions">
                                <button class="btn btn-small btn-secondary" onclick="openFolder('entertainment')">
                                    <i class="fas fa-eye"></i>
                                    –ü—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                                <button class="btn btn-small btn-primary" onclick="manageFolder('entertainment')">
                                    <i class="fas fa-cog"></i>
                                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Videos -->
                <div class="content-section">
                    <h2>–ù–µ–¥–∞–≤–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –≤–∏–¥–µ–æ</h2>
                    
                    <div class="videos-list" id="recentVideos">
                        <div class="video-item">
                            <div class="video-thumbnail">
                                <i class="fas fa-play-circle"></i>
                            </div>
                            <div class="video-info">
                                <h4>motivation_success_001.mp4</h4>
                                <p>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ú–æ—Ç–∏–≤–∞—Ü–∏—è</p>
                                <span class="video-meta">15 MB ‚Ä¢ 2:30 ‚Ä¢ 2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</span>
                            </div>
                            <div class="video-actions">
                                <button class="btn btn-small btn-secondary">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
                                <button class="btn btn-small btn-primary">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button>
                            </div>
                        </div>

                        <div class="video-item">
                            <div class="video-thumbnail">
                                <i class="fas fa-play-circle"></i>
                            </div>
                            <div class="video-info">
                                <h4>lifestyle_morning_routine.mp4</h4>
                                <p>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –õ–∞–π—Ñ—Å—Ç–∞–π–ª</p>
                                <span class="video-meta">22 MB ‚Ä¢ 1:45 ‚Ä¢ 4 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</span>
                            </div>
                            <div class="video-actions">
                                <button class="btn btn-small btn-secondary">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
                                <button class="btn btn-small btn-primary">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- JavaScript -->
    <script src="/static/js/dashboard.js"></script>
    <script>
        console.log('üìÅ Content page loaded');

        // Drag & Drop —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        const uploadArea = document.getElementById('uploadArea');
        const videoFiles = document.getElementById('videoFiles');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('drag-over');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('drag-over');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('drag-over');
            
            const files = e.dataTransfer.files;
            console.log('üé¨ Files dropped:', files.length);
            handleFileUpload(files);
        });

        uploadArea.addEventListener('click', () => {
            videoFiles.click();
        });

        videoFiles.addEventListener('change', (e) => {
            console.log('üìÅ Files selected:', e.target.files.length);
            handleFileUpload(e.target.files);
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
        async function handleFileUpload(files) {
            if (files.length === 0) return;

            const category = document.getElementById('videoCategory').value;
            const tags = document.getElementById('videoTags').value;
            
            console.log(`üîÑ Uploading ${files.length} files to category: ${category}`);

            // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
            const progressContainer = document.getElementById('uploadProgress');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            progressContainer.style.display = 'block';

            const formData = new FormData();
            
            for (let file of files) {
                if (file.size > 100 * 1024 * 1024) { // 100MB limit
                    alert(`‚ùå –§–∞–π–ª ${file.name} —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å. 100MB)`);
                    continue;
                }
                formData.append('videos', file);
            }
            formData.append('category', category);
            formData.append('tags', tags);

            try {
                const response = await fetch('/api/content/upload', {
                    method: 'POST',
                    body: formData
                });

                // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += 10;
                    progressFill.style.width = progress + '%';
                    progressText.textContent = progress + '%';
                    
                    if (progress >= 100) {
                        clearInterval(progressInterval);
                    }
                }, 200);

                const result = await response.json();

                setTimeout(() => {
                    progressContainer.style.display = 'none';
                    
                    if (result.success) {
                        alert(`‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${files.length} –≤–∏–¥–µ–æ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é "${category}"!`);
                        loadFolders();
                        loadRecentVideos();
                        
                        // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
                        videoFiles.value = '';
                        document.getElementById('videoTags').value = '';
                    } else {
                        alert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + result.message);
                    }
                }, 2000);

            } catch (error) {
                progressContainer.style.display = 'none';
                console.error('Upload error:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message);
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–ø–∫–∞–º–∏
        async function loadFolders() {
            try {
                console.log('üìÇ Loading folders...');
                const response = await fetch('/api/content/folders');
                const folders = await response.json();
                
                console.log('‚úÖ Loaded folders:', folders.length);
                // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞–ø–æ–∫
            } catch (error) {
                console.error('‚ùå Error loading folders:', error);
            }
        }

        async function refreshFolders() {
            console.log('üîÑ Refreshing folders...');
            await loadFolders();
        }

        function openFolder(folderName) {
            console.log('üìÇ Opening folder:', folderName);
            alert(`üìÇ –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–∞–ø–∫–∏: ${folderName}\n(–í –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–∏–¥–µ–æ)`);
        }

        function manageFolder(folderName) {
            console.log('‚öôÔ∏è Managing folder:', folderName);
            alert(`‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–ø–∫–æ–π: ${folderName}\n(–í –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∑–¥–µ—Å—å –±—É–¥—É—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–ø–∫–∏)`);
        }

        function createNewFolder() {
            const folderName = prompt('üìÅ –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –ø–∞–ø–∫–∏:');
            if (folderName) {
                console.log('‚úÖ Creating folder:', folderName);
                alert(`‚úÖ –ü–∞–ø–∫–∞ "${folderName}" –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞`);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–¥–∞–≤–Ω–∏—Ö –≤–∏–¥–µ–æ
        async function loadRecentVideos() {
            try {
                console.log('üé¨ Loading recent videos...');
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç API –∑–∞–ø—Ä–æ—Å
                console.log('‚úÖ Recent videos loaded');
            } catch (error) {
                console.error('‚ùå Error loading recent videos:', error);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Content page initialized');
            loadFolders();
            loadRecentVideos();
        });
    </script>
</body>
</html> 