<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–∫–∫–∞—É–Ω—Ç—ã - MediaFlux Hub</title>
    <link rel="stylesheet" href="/static/css/main.css">
    
    <!-- –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ö–ù–û–ü–û–ö -->
    <style>
        .force-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            padding: 15px 30px !important;
            border: none !important;
            border-radius: 12px !important;
            font-size: 16px !important;
            font-weight: bold !important;
            cursor: pointer !important;
            margin: 10px !important;
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4) !important;
            transition: all 0.3s ease !important;
            text-decoration: none !important;
            z-index: 999999 !important;
            position: relative !important;
        }
        
        .force-button:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6) !important;
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%) !important;
        }
        
        .force-form {
            background: #252d3a !important;
            padding: 25px !important;
            border-radius: 15px !important;
            margin: 20px 0 !important;
            border: 2px solid #667eea !important;
        }
        
        .force-input {
            width: 100% !important;
            padding: 12px !important;
            margin: 10px 0 !important;
            border: 2px solid #667eea !important;
            border-radius: 8px !important;
            background: #1a1f2e !important;
            color: white !important;
            font-size: 14px !important;
        }
        
        .force-label {
            color: #ffffff !important;
            font-weight: bold !important;
            margin: 10px 0 5px 0 !important;
            display: block !important;
        }
        
        .success-message {
            background: #10b981 !important;
            color: white !important;
            padding: 15px !important;
            border-radius: 8px !important;
            margin: 10px 0 !important;
            display: none !important;
        }
        
        .error-message {
            background: #ef4444 !important;
            color: white !important;
            padding: 15px !important;
            border-radius: 8px !important;
            margin: 10px 0 !important;
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- –ü—Ä–æ—Å—Ç–æ–π —Å–∞–π–¥–±–∞—Ä -->
        <nav class="sidebar">
            <div class="logo">
                <span class="logo-icon">üì±</span>
                <span class="logo-text">MediaFlux Hub</span>
            </div>
            <ul class="nav-menu">
                <li><a href="/" class="nav-link">üìä Dashboard</a></li>
                <li><a href="/accounts" class="nav-link active">üë• –ê–∫–∫–∞—É–Ω—Ç—ã</a></li>
                <li><a href="/content" class="nav-link">üìÅ –ö–æ–Ω—Ç–µ–Ω—Ç</a></li>
                <li><a href="/schedule" class="nav-link">üìÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</a></li>
                <li><a href="/analytics" class="nav-link">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
                <li><a href="/proxies" class="nav-link">üõ°Ô∏è –ü—Ä–æ–∫—Å–∏</a></li>
                <li><a href="/settings" class="nav-link">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
            </ul>
        </nav>

        <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ –° –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –í–ò–î–ò–ú–´–ú–ò –ö–ù–û–ü–ö–ê–ú–ò -->
        <main class="main-content">
            <header class="page-header">
                <h1 style="color: white;">üî• –£–ü–†–ê–í–õ–ï–ù–ò–ï –ê–ö–ö–ê–£–ù–¢–ê–ú–ò - –†–ê–ë–û–ß–ò–ï –ö–ù–û–ü–ö–ò!</h1>
                <p style="color: #94a3b8;">–î–æ–±–∞–≤–ª—è–π—Ç–µ –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ Instagram –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏</p>
            </header>

            <!-- –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø -->
            <div id="successMessage" class="success-message"></div>
            <div id="errorMessage" class="error-message"></div>

            <!-- –§–û–†–ú–ê –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ê–ö–ö–ê–£–ù–¢–ê -->
            <div class="force-form">
                <h2 style="color: #667eea; margin-bottom: 20px;">‚ûï –î–û–ë–ê–í–ò–¢–¨ –ù–û–í–´–ô –ê–ö–ö–ê–£–ù–¢</h2>
                
                <form id="addAccountForm">
                    <label class="force-label">Instagram Username:</label>
                    <input type="text" id="username" name="username" class="force-input" placeholder="@your_instagram_account" required>
                    
                    <label class="force-label">Instagram Access Token:</label>
                    <textarea id="access_token" name="access_token" class="force-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à Instagram Graph API —Ç–æ–∫–µ–Ω" rows="4" required></textarea>
                    
                    <label class="force-label">Instagram Account ID:</label>
                    <input type="text" id="account_id" name="account_id" class="force-input" placeholder="1234567890123456" required>
                    
                    <label class="force-label">–ü—Ä–æ–∫—Å–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                    <input type="text" id="proxy" name="proxy" class="force-input" placeholder="http://user:pass@ip:port">
                    
                    <label class="force-label">–î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –ø–æ—Å—Ç–æ–≤:</label>
                    <select id="daily_limit" name="daily_limit" class="force-input">
                        <option value="2">2 –ø–æ—Å—Ç–∞ –≤ –¥–µ–Ω—å</option>
                        <option value="5" selected>5 –ø–æ—Å—Ç–æ–≤ –≤ –¥–µ–Ω—å</option>
                        <option value="8">8 –ø–æ—Å—Ç–æ–≤ –≤ –¥–µ–Ω—å</option>
                    </select>
                    
                    <!-- –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û –í–ò–î–ò–ú–´–ï –ö–ù–û–ü–ö–ò -->
                    <div style="margin-top: 25px;">
                        <button type="button" class="force-button" onclick="testConnection()">
                            üîó –¢–ï–°–¢ –°–û–ï–î–ò–ù–ï–ù–ò–Ø
                        </button>
                        
                        <button type="submit" class="force-button">
                            ‚úÖ –î–û–ë–ê–í–ò–¢–¨ –ê–ö–ö–ê–£–ù–¢
                        </button>
                        
                        <button type="button" class="force-button" onclick="loadAccounts()">
                            üîÑ –û–ë–ù–û–í–ò–¢–¨ –°–ü–ò–°–û–ö
                        </button>
                    </div>
                </form>
            </div>

            <!-- –°–ü–ò–°–û–ö –ê–ö–ö–ê–£–ù–¢–û–í -->
            <div class="force-form">
                <h2 style="color: #667eea; margin-bottom: 20px;">üë• –ú–û–ò –ê–ö–ö–ê–£–ù–¢–´</h2>
                
                <div id="accountsList" style="min-height: 200px;">
                    <!-- –î–µ–º–æ –∞–∫–∫–∞—É–Ω—Ç—ã -->
                    <div style="background: #1a1f2e; padding: 20px; border-radius: 12px; margin: 15px 0; border: 1px solid #667eea;">
                        <h3 style="color: white; margin: 0 0 10px 0;">üì∏ @demo_fashion_account</h3>
                        <p style="color: #94a3b8; margin: 5px 0;">–°—Ç–∞—Ç—É—Å: ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω | –ü–æ—Å—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è: 3/5 | –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</p>
                        
                        <button class="force-button" onclick="editAccount('demo_fashion')">
                            ‚úèÔ∏è –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨
                        </button>
                        
                        <button class="force-button" onclick="viewStats('demo_fashion')">
                            üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê
                        </button>
                        
                        <button class="force-button" onclick="deleteAccount('demo_fashion')">
                            üóëÔ∏è –£–î–ê–õ–ò–¢–¨
                        </button>
                    </div>

                    <div style="background: #1a1f2e; padding: 20px; border-radius: 12px; margin: 15px 0; border: 1px solid #667eea;">
                        <h3 style="color: white; margin: 0 0 10px 0;">‚ú® @demo_lifestyle_blog</h3>
                        <p style="color: #94a3b8; margin: 5px 0;">–°—Ç–∞—Ç—É—Å: ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω | –ü–æ—Å—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è: 2/8 | –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 1 —á–∞—Å –Ω–∞–∑–∞–¥</p>
                        
                        <button class="force-button" onclick="editAccount('demo_lifestyle')">
                            ‚úèÔ∏è –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨
                        </button>
                        
                        <button class="force-button" onclick="viewStats('demo_lifestyle')">
                            üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê
                        </button>
                        
                        <button class="force-button" onclick="deleteAccount('demo_lifestyle')">
                            üóëÔ∏è –£–î–ê–õ–ò–¢–¨
                        </button>
                    </div>
                </div>
                
                <button class="force-button" onclick="loadAccounts()">
                    üîÑ –ó–ê–ì–†–£–ó–ò–¢–¨ –í–°–ï –ê–ö–ö–ê–£–ù–¢–´
                </button>
            </div>
        </main>
    </div>

    <!-- –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –°–£–©–ï–°–¢–í–£–Æ–©–ï–ì–û –§–£–ù–ö–¶–ò–û–ù–ê–õ–ê -->
    <script src="/static/js/dashboard.js"></script>
    
    <!-- –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ –ö–ù–û–ü–û–ö -->
    <script>
        console.log('üöÄ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–´–ï –ö–ù–û–ü–ö–ò –ó–ê–ì–†–£–ñ–ï–ù–´!');

        // –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –°–û–û–ë–©–ï–ù–ò–ô
        function showMessage(message, type = 'success') {
            const successDiv = document.getElementById('successMessage');
            const errorDiv = document.getElementById('errorMessage');
            
            if (type === 'success') {
                successDiv.textContent = message;
                successDiv.style.display = 'block';
                errorDiv.style.display = 'none';
            } else {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                successDiv.style.display = 'none';
            }
            
            setTimeout(() => {
                successDiv.style.display = 'none';
                errorDiv.style.display = 'none';
            }, 5000);
        }

        // –§–û–†–ú–ê –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ê–ö–ö–ê–£–ù–¢–ê
        document.getElementById('addAccountForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            console.log('üìù –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã –∞–∫–∫–∞—É–Ω—Ç–∞...');
            
            const formData = new FormData(this);
            const accountData = Object.fromEntries(formData);
            
            try {
                showMessage('‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞...', 'success');
                
                const response = await fetch('/api/accounts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(accountData)
                });
                
                const result = await response.json();
                console.log('üì® –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', result);
                
                if (result.success) {
                    showMessage('‚úÖ –ê–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
                    this.reset();
                    loadAccounts();
                } else {
                    showMessage('‚ùå –û—à–∏–±–∫–∞: ' + (result.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'), 'error');
                }
            } catch (error) {
                console.error('üí• –û—à–∏–±–∫–∞:', error);
                showMessage('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + error.message, 'error');
            }
        });

        // –¢–ï–°–¢ –°–û–ï–î–ò–ù–ï–ù–ò–Ø
        async function testConnection() {
            console.log('üîó –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...');
            
            const username = document.getElementById('username').value;
            const access_token = document.getElementById('access_token').value;
            
            if (!username || !access_token) {
                showMessage('‚ùå –í–≤–µ–¥–∏—Ç–µ username –∏ access token –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                return;
            }
            
            try {
                showMessage('‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...', 'success');
                
                const response = await fetch('/api/accounts/test', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        username: username,
                        access_token: access_token
                    })
                });
                
                const result = await response.json();
                console.log('üîç –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:', result);
                
                if (result.success) {
                    showMessage(`‚úÖ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ! –ü–æ–¥–ø–∏—Å—á–∏–∫–∏: ${result.account_info?.followers || 'N/A'}`, 'success');
                } else {
                    showMessage('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ' + (result.message || '–¢–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω'), 'error');
                }
            } catch (error) {
                console.error('üí• –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞:', error);
                showMessage('‚ùå –û—à–∏–±–∫–∞: ' + error.message, 'error');
            }
        }

        // –ó–ê–ì–†–£–ó–ö–ê –ê–ö–ö–ê–£–ù–¢–û–í
        async function loadAccounts() {
            console.log('üì• –ó–∞–≥—Ä—É–∑–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤...');
            
            try {
                showMessage('‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤...', 'success');
                
                const response = await fetch('/api/accounts');
                const accounts = await response.json();
                
                console.log('üìã –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤:', accounts.length);
                showMessage(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${accounts.length} –∞–∫–∫–∞—É–Ω—Ç–æ–≤`, 'success');
                
                // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
                updateAccountsList(accounts);
                
            } catch (error) {
                console.error('üí• –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                showMessage('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤: ' + error.message, 'error');
            }
        }

        // –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–ü–ò–°–ö–ê –ê–ö–ö–ê–£–ù–¢–û–í
        function updateAccountsList(accounts) {
            const accountsList = document.getElementById('accountsList');
            
            if (accounts && accounts.length > 0) {
                accountsList.innerHTML = accounts.map(account => `
                    <div style="background: #1a1f2e; padding: 20px; border-radius: 12px; margin: 15px 0; border: 1px solid #667eea;">
                        <h3 style="color: white; margin: 0 0 10px 0;">üì∏ ${account.username}</h3>
                        <p style="color: #94a3b8; margin: 5px 0;">
                            –°—Ç–∞—Ç—É—Å: ${account.status === 'active' ? '‚úÖ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ùå –ù–µ–∞–∫—Ç–∏–≤–µ–Ω'} | 
                            –ü–æ—Å—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è: ${account.posts_today}/${account.daily_limit} | 
                            –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${account.last_activity}
                        </p>
                        
                        <button class="force-button" onclick="editAccount('${account.id}')">
                            ‚úèÔ∏è –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨
                        </button>
                        
                        <button class="force-button" onclick="viewStats('${account.id}')">
                            üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê
                        </button>
                        
                        <button class="force-button" onclick="deleteAccount('${account.id}')">
                            üóëÔ∏è –£–î–ê–õ–ò–¢–¨
                        </button>
                    </div>
                `).join('');
            }
        }

        // –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –ê–ö–ö–ê–£–ù–¢–ê
        function editAccount(accountId) {
            console.log('‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞:', accountId);
            showMessage(`‚úèÔ∏è –û—Ç–∫—Ä—ã—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ ${accountId}`, 'success');
        }

        // –ü–†–û–°–ú–û–¢–† –°–¢–ê–¢–ò–°–¢–ò–ö–ò
        function viewStats(accountId) {
            console.log('üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞:', accountId);
            showMessage(`üìä –û—Ç–∫—Ä—ã—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ ${accountId}`, 'success');
            window.location.href = `/analytics?account=${accountId}`;
        }

        // –£–î–ê–õ–ï–ù–ò–ï –ê–ö–ö–ê–£–ù–¢–ê
        function deleteAccount(accountId) {
            console.log('üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞:', accountId);
            
            const confirmed = confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç ${accountId}?`);
            
            if (confirmed) {
                showMessage(`üóëÔ∏è –ê–∫–∫–∞—É–Ω—Ç ${accountId} —É–¥–∞–ª–µ–Ω`, 'success');
            }
        }

        // –ê–í–¢–û–ó–ê–ì–†–£–ó–ö–ê –ê–ö–ö–ê–£–ù–¢–û–í –ü–†–ò –û–¢–ö–†–´–¢–ò–ò –°–¢–†–ê–ù–ò–¶–´
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...');
            loadAccounts();
        });
    </script>
</body>
</html> 